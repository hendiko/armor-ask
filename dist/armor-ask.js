// armor-ask v0.1.1 Thu Aug 09 2018  
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ArmorAsk=t():e.ArmorAsk=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var s=t[r]={i:r,l:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.l=!0,s.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)n.d(r,s,function(t){return e[t]}.bind(null,s));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var r=f(n(1)),s=f(n(6)),u=f(n(5)),o=n(2),i=n(4),a=n(3);function f(e){return e&&e.__esModule?e:{default:e}}var c={ask:function(e,t){return(0,r.default)(e,t)},answer:function(e,t,n){return(0,s.default)(this,e,t,n)},shut:function(e,t){return(0,u.default)(this,e,t)}},l={has:function(e,t){e=(0,a.safeQuestion)(e);var n=t||{},r=n.ns,s=n.all;r=(0,a.safeNs)(r);for(var u=s?Object.keys(o.namespaces):[r],f=void 0,c=void 0,l=!1,d=0;d<u.length;d++)if((f=(0,o.getRegistry)(u[d]))&&(c=f[e])&&c.hasOwnProperty(i.SOLUTION)){l=!0;break}return l},list:function(e){var t=e||{},n=t.ns,r=t.all;n=(0,a.safeNs)(n);for(var s=r?Object.keys(o.namespaces):[n],u={},f=void 0,c=void 0,l=0;l<s.length;l++)if(f=(0,o.getRegistry)(s[l])){var d=[];for(var v in f)(c=f[v])&&c.hasOwnProperty(i.SOLUTION)&&d.push(v);d.length&&(u[s[l]]=d)}return u},_getNamespaces:function(){return Object.assign({},o.namespaces)}};Object.assign(c.ask,l),e.exports=c},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t){var n=t||{},i=n.evaluate,a=void 0===i||i,f=n.ns,c=n.wait,l=n.params;c*=1,(0,s.isNumber)(c)||(c=0);f=(0,s.safeNs)(f);var d=(0,r.getRegistry)(f,c);if(!d)return;e=(0,s.safeQuestion)(e);var v=d[e];if(!v&&!c)return;v||(v=d[e]={waiting:[]});if(v.hasOwnProperty(u.SOLUTION)){var p=v,g=p[u.SOLUTION],y=p.ctx,m=p.once,_=p.answerer;return m&&(0,o.default)(_,e,{ns:f}),function(e,t){return t?Promise.resolve(e):e}(a&&(0,s.isFunction)(g)?g.call(y,l,e,f):g,c)}return c?new Promise(function(t,n){var r=void 0;c>0&&(r=setTimeout(function(){u._rejected=!0,n(e)},c));var u=function(n,u){c>0&&clearTimeout(r);var o=a&&(0,s.isFunction)(n)?n.call(u,l,e,f):n;t(o)};v.waiting.push(u)}):void 0};var r=n(2),s=n(3),u=n(4),o=function(e){return e&&e.__esModule?e:{default:e}}(n(5))},function(e,t,n){"use strict";t.__esModule=!0,t.namespaces=void 0,t.getRegistry=function(e,t){e=(0,r.safeNs)(e);var n=s[e];!n&&t&&(n=s[e]={});return n};var r=n(3),s=t.namespaces={default:{}}},function(e,t,n){"use strict";t.__esModule=!0,t.isFunction=function(e){return"function"==typeof e},t.isNumber=function(e){return"number"==typeof e&&!isNaN(e)&&e!==1/0},t.safeNs=function(e){return void 0==e?"default":e},t.safeQuestion=function(e){return void 0==e?"":e}},function(e,t,n){"use strict";t.__esModule=!0;t.SOLUTION="solution"},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t,n){var r=n||{},o=r.ns,i=r.all;o=(0,s.safeNs)(o);var a=e._armorAskAnswers;if(!a||!a.length)return e;for(var f=void 0,c=[],l=0;l<a.length;l++)f=a[l],void 0!=t&&t!==f.question||!i&&f.ns!==o?c.push(f):u(f);return e._armorAskAnswers=c,e};var r=n(2),s=n(3);function u(e){var t=e.question,n=e.ns,u=e.registry;n=(0,s.safeNs)(n);var o=u[t=(0,s.safeNs)(t)]||{},i=o.waiting,a=o.onShut,f=o.ctx;i&&i.length?u[t]={waiting:i}:(delete u[t],Object.keys(u).length||delete r.namespaces[n]),(0,s.isFunction)(a)&&a.call(f,t,n)}},function(e,t,n){"use strict";t.__esModule=!0,t.default=function(e,t,n,i){var a,f=i||{},c=f.update,l=f.ns,d=f.ctx,v=f.once,p=f.onShut;d||(d=e);t=(0,o.safeQuestion)(t),l=(0,o.safeNs)(l);var g=(0,s.getRegistry)(l,!0),y=g[t],m=(y||{}).waiting;if(y&&y.hasOwnProperty(u.SOLUTION)){if(!c)return!1;(0,r.default)(y.answerer,t,{ns:l}),s.namespaces[l]=g}y=g[t]=((a={})[u.SOLUTION]=n,a.ctx=d,a.waiting=m,a.answerer=e,a.once=v,a.onShut=p,a),e._armorAskAnswers||(e._armorAskAnswers=[]);if(e._armorAskAnswers.push({question:t,ns:l,registry:g}),m&&m.length)for(var _=void 0;m.length;)if(!(_=m.shift())._rejected&&(_(n,d),v)){(0,r.default)(e,t,{ns:l});break}return!0};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(5)),s=n(2),u=n(4),o=n(3)}])});